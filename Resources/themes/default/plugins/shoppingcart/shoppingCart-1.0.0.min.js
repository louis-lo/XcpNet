/*!
 * 购物车增删改查的公共方法，适用于pc和手机端
 *  Requires cnaws.js and jQuery or Zepto
 * @version 1.0.0
 * @author liu mixoaxin  2016-07-25
 */
+function(n,t){"use strict";var i=Cnaws||{};i.Cart=function(n){var r={addUrl:Cnaws.getUrl("/cart/add"),loginUrl:Cnaws.getPassUrl("/login"),getCountUrl:Cnaws.getUrl("/cart/count"),delUrl:Cnaws.getUrl("/cart/del"),getListUrl:Cnaws.getUrl("/cart/getList"),buyUrl:Cnaws.getUrl("/buy"),getPaymentUrl:function(n){return Cnaws.getPassUrl("/buy/perfect/"+n)}},i=this;this.options=t.extend({},r,n);this.add=function(n,r,u){t.post(this.options.addUrl,{id:n,count:r},function(n){if(n.code===-200)Cnaws.showSuccess("添加成功"),typeof u=="function"&&u(n);else{if(n.code===-401){Cnaws.showError("请先登录");location.href=i.options.loginUrl;return}n.code===-1023?Cnaws.showError("找不到该商品"):n.code===-1027?Cnaws.showError("库存不足"):Cnaws.showError("已添加过该宝贝")}},"json")};this.getCount=function(n){t.get(i.options.getCountUrl,function(i){typeof n=="string"&&t(n).html(i.data);typeof n=="function"&&n(i)},"json")};this.del=function(n,r){t.post(i.options.delUrl,{id:n},function(n){n.code===-200?typeof r=="function"&&r(n):ShowBox.showErrorByCode(n.code)},"json")};this.getList=function(n){t.get(i.options.getListUrl,function(t){t.code===-200?typeof n=="function"&&n(t):ShowBox.showErrorByCode(t.code)},"json")};this.buy=function(n,r,u){t.post(i.options.buyUrl,{Id:n,Count:r},function(n){n.code===-200?typeof u=="function"?u(n):location.href=i.options.getPaymentUrl(n.data.OrderId):ShowBox.showErrorByCode(n.code)},"json")}};window.Cnaws=i}(document,$||Zepto);